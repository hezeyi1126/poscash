<!DOCTYPE html>
<html class="x-admin-sm">

<head>
<meta charset="UTF-8">
<title>用户列表</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
<link rel="stylesheet" href="/css/font.css">
<link rel="stylesheet" href="/css/xadmin.css">

<script src="/js/jquery.min.js" charset="utf-8"></script>
<script src="/lib/layui/layui.all.js" charset="utf-8"></script>
<script type="text/javascript" src="/js/tools.js"></script>
</head>
<body>

	<div class="layui-fluid">
		<!-- 表格显示面板  👇-->
		<div class="layui-row layui-col-space15" id="dataPane">
			<div class="layui-col-md12">
				<div class="layui-card">
					<!-- 查询面板 👇-->
					<form class="layui-form" action="">
						<div class="layui-card-body " id="searchPane">

							<div class="layui-input-inline lafite_search layui-show-xs-block">
								<button type="button" class="layui-btn  " onclick="search()">

									查询</button>
							</div>
						</div>
					</form>
					<!-- 查询面板 👆-->

					<div class="layui-card-body">

						<div id="test1"></div>


					</div>
					<div id="lafite_pages"></div>
				</div>
			</div>
		</div>
		<!-- 表格显示面板  👆-->


		<!-- 编辑面板  👇-->
		<div class="layui-row layui-col-space10" id="editPane"
			style="display: none">
			<form class="layui-form" id="editform">
				<div class="layui-form-item">
					<label for="L_email" class="layui-form-label"> <span
						class="x-red">*</span> 类型ID
					</label>
					<div class="layui-input-block lafite_width_60">
						<input type="text" id="typeId" name="typeId" lay-verify="required"
							autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label for="L_email" class="layui-form-label"> <span
						class="x-red">*</span> 菜单名称
					</label>
					<div class="layui-input-block lafite_width_60">
						<input type="text" id="typeName" name="typeName"
							lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<input type="hidden" name="parentId" /> <input type="hidden"
					name="isAviable" /> <input type="hidden" name="sortFlag" /> <input
					type="hidden" name="createUserId" /> <input type="hidden"
					name="createTime" />



				<div class="layui-form-item">
					<div class="layui-input-block">
						<div class="lafite-layui-btn lafite_float_left lafite_height_35px"
							onclick="back()">取消</div>
						<button lay-submit lay-filter="subform"
							class="lafite-layui-btn2 lafite_margin_left_10 lafite_height_35px">保存</button>
					</div>
				</div>

			</form>
		</div>
		<!-- 编辑面板  👆-->


	</div>





</body>
<script>
	var loadingtype = 3;
	var service = "busGoodsTypeService"
	var queryid = "busGoodsTypeQuery"
	var cmd = "add";//默认为添加 可以为edit
	$(document).ready(function() {

	});

	layui.use([ "tree"], function() {
		var tree = layui.tree;
		var data1 = [{
		    title: '江西'
		        ,id: 1
		        ,children: [{
		          title: '南昌'
		          ,id: 1000
		          ,children: [{
		            title: '青山湖区'
		            ,id: 10001
		          },{
		            title: '高新区'
		            ,id: 10002
		          }]
		        },{
		          title: '九江'
		          ,id: 1001
		        },{
		          title: '赣州'
		          ,id: 1002
		        }]
		      },{
		        title: '广西'
		        ,id: 2
		        
		      },{
		        title: '陕西'
		        ,id: 3
		        ,children: [{
		          title: '西安'
		          ,id: 3000
		        },{
		          title: '延安'
		          ,id: 3001
		        }]
		      }];
		//无连接线风格
		tree.render({
		    elem: '#test1'
		    ,data: data1
		    ,edit: ['add', 'update', 'del'] //操作节点的图标
		    ,click: function(obj){
		      layer.msg(JSON.stringify(obj.data));
		    },operate : function(obj){
		    	console.log(obj);
		    	return false;
		    }
		  });
	});
/**-------------------------------------------------------------------------------------------------------------------------------------------------------------*/
	/*添加用户*/
	function add() {
		clearForm();
		goedit() ;
		cmd = "add";
	}

	function goedit() {
		cmd = "edit";
		$("#dataPane").hide();
		$("#editPane").fadeIn(200);
	}

	function back() {
		$("#dataPane").fadeIn(200);
		$("#editPane").hide();
	}
	
	/**
	清空form内容
	*/
	function clearForm(){
		$("#editform input,select,textarea").val("");
	}
	

	/*编辑*/
	function edit( id) {
		 var loadindex = layer.load(loadingtype);
		pro.callServer(service, "getBId",{typeId : id},function(res){
			layer.close(loadindex);
			
			if(res.data.state == '1'){
				console.log(res);
				//清除页面的值
				 clearForm();
				//绑定值
				fillForm(res.data.data)
				//进入编辑页面
				goedit();
			}
		});
	}
	/*用户-删除*/
	function del( id) {
		layer.confirm('是否确认删除当前项目？', {
			title : "项目删除"
		}, function(index) {
			//发异步删除数据
			 var loadindex = layer.load(loadingtype);
			pro.callServer(service, "del",{typeId : id},function(res){
				layer.close(loadindex);
				layer.msg(res.data.msg);
				if(res.data.state == '1'){
					//刷新页面
					back();
					search();
				}
			});
			
		});
	}
	
	/**
	删除选中条目
	*/
	function delSelected(data){
		var ids = "";
		for(var i = 0 ;i < data.length;i++){
			ids += data[i].typeId + ",";
		}
		ids = ids.substring(0 , ids.length - 1);
		layer.confirm('是否确认删除当前项目？', {
			title : "项目删除"
		}, function(index) {
			console.log(index)
			//发异步删除数据
			 var loadindex = layer.load(loadingtype);
			 pro.callServer(service, "delSelected",{ids : ids},function(res){
					layer.close(loadindex);
					layer.msg(res.data.msg);
					if(res.data.state == '1'){
						//刷新页面
						back();
						search();
					}
				});
			 
		
		});
		
	}

</script>

</html>